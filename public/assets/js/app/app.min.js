function initApp(){return maintenance||(appReadHeader(),appReadFooter(),appReadContentsIndex()),$(document).on("click","#external_link",function(a){a.preventDefault();var b="_system",c=$(this).attr("href");window.open(c,b)}),document.addEventListener("resume",function(){var a,b=+new Date;a=maintenance?1e3:864e5,dateFirstAccess+a<b?window.location.reload():readNotificationsUnreadTotal()}),maintenance?void alert("Game Usersは現在、メンテナンス中です"):void 0}function getDeviceToken(){pushNotification=window.plugins.pushNotification,"android"==device.platform||"Android"==device.platform?pushNotification.register(successHandler,errorHandler,{senderID:"735599708800",ecb:"onNotificationGCM"}):pushNotification.register(tokenHandler,errorHandler,{badge:"true",sound:"true",alert:"true",ecb:"onNotificationAPN"})}function successHandler(){}function errorHandler(){}function onNotificationGCM(a){switch(a.event){case"registered":a.regid.length>0&&saveDeviceInfo(a.regid,null);break;case"message":readNotificationsUnreadTotal();break;case"error":}}function onNotificationAPN(a){if(readNotificationsUnreadTotal(),a.alert&&navigator.notification.alert(a.alert),a.sound){var b=new Media(a.sound);b.play()}a.badge&&pushNotification.setApplicationIconBadgeNumber(successHandler,errorHandler,a.badge)}function tokenHandler(a){saveDeviceInfo(a,null)}function saveDeviceInfo(a,b){var c=new FormData;if(b){if(!window.confirm("このデバイスで通知を受けますか？"))return;c.append("on_off_app","on"),c.append("receive_device",device.uuid)}else c.append("type",device.platform),c.append("id",device.uuid),c.append("name",device.model+" / "+device.platform+" "+device.version),c.append("token",a);var d=$("#form_fuel_csrf_token").val();c.append("fuel_csrf_token",d),$.ajax({url:uri_base+"rest/user/save_notification_data.json",dataType:"json",type:"POST",data:c,enctype:"multipart/form-data",processData:!1,contentType:!1}).done(function(a){a.new_device&&saveDeviceInfo(null,!0)}).fail(function(){alert("error")}).always(function(){})}function appReadHeader(){var a=new FormData;$.ajax({url:uri_base+"rest/app/header.json",dataType:"json",type:"POST",data:a,enctype:"multipart/form-data",processData:!1,contentType:!1}).done(function(a){$("#app_header").html(a.code),loadingComplete(!0,!1,!1)}).fail(function(){alert("error")}).always(function(){})}function appReadFooter(){var a=new FormData;$.ajax({url:uri_base+"rest/app/footer.json",dataType:"json",type:"POST",data:a,enctype:"multipart/form-data",processData:!1,contentType:!1}).done(function(a){$("#app_footer").html(a.code);var b=$("#form_fuel_csrf_token").val();$.cookie("fuel_csrf_token",b),$("#app_go_to_top").on("click",function(){scrollToAnchor("#app_header",0,0)}),loadingComplete(!1,!0,!1),getDeviceToken()}).fail(function(){}).always(function(){})}function appReadContentsIndex(){var a=new FormData;a.append("app_mode",1),$.ajax({url:uri_base+"rest/app/contents_index.json",dataType:"json",type:"POST",data:a,enctype:"multipart/form-data",processData:!1,contentType:!1}).done(function(a){$("#app_container").html(a.code),initLogin(a.content_id),readNotificationsUnreadTotal(),loadingComplete(!1,!1,!0)}).fail(function(){}).always(function(){})}function appReadContentsLogin(){var a=new FormData;a.append("app_mode",1),$.ajax({url:uri_base+"rest/app/contents_login.json",dataType:"json",type:"POST",data:a,enctype:"multipart/form-data",processData:!1,contentType:!1}).done(function(a){$("#app_container").html(a.code),initLogin(a.content_id),readNotificationsUnreadTotal()}).fail(function(){}).always(function(){})}function appReadContentsLogout(){var a=new FormData;a.append("app_mode",1),$.ajax({url:uri_base+"rest/app/contents_logout.json",dataType:"json",type:"POST",data:a,enctype:"multipart/form-data",processData:!1,contentType:!1}).done(function(a){$("#app_container").html(a.code),initLogout(a.content_id),readNotificationsUnreadTotal()}).fail(function(){}).always(function(){})}function loadingComplete(a,b,c){a&&(loadedHeader=!0),b&&(loadedFooter=!0),c&&(loadedIndex=!0),loadedHeader&&loadedFooter&&loadedIndex&&navigator.splashscreen.hide()}var appEnvironment="production";if("phonegap_desktop"==appEnvironment)var uri_base="http://localhost/gameusers/public/",uri_current="http://localhost/gameusers/public/",testMode=!0;else if("app_test"==appEnvironment)var uri_base="http://192.168.10.2/gameusers/public/",uri_current="http://192.168.10.2/gameusers/public/";else if("production"==appEnvironment)var uri_base="https://gameusers.org/",uri_current="https://gameusers.org/";var language="ja",appMode=!0,loadedIndex=!1,loadedHeader=!1,loadedFooter=!1,appUserTermsApproval=!1,pushNotification,maintenance=!1;
GAMEUSERS.namespace("GAMEUSERS.webpush"),GAMEUSERS.webpush.endpoint=null,GAMEUSERS.webpush.publicKey=null,GAMEUSERS.webpush.authToken=null,$(function(){"player"==webpush_type&&GAMEUSERS.webpush.startWebPush(webpush_type)}),GAMEUSERS.webpush.startWebPush=function(a){!("serviceWorker"in navigator),"showNotification"in ServiceWorkerRegistration.prototype&&"denied"!==Notification.permission&&"PushManager"in window&&navigator.serviceWorker.register(uri_base+"service_worker.min.js").then(function(a){return a.pushManager.getSubscription().then(function(b){return b?b:a.pushManager.subscribe({userVisibleOnly:!0})})}).then(function(a){var b=a.getKey?a.getKey("p256dh"):"";GAMEUSERS.webpush.publicKey=b?btoa(String.fromCharCode.apply(null,new Uint8Array(b))):"";var c=a.getKey?a.getKey("auth"):"";GAMEUSERS.webpush.authToken=c?btoa(String.fromCharCode.apply(null,new Uint8Array(c))):"",GAMEUSERS.webpush.endpoint=a.endpoint,"player"==webpush_type&&GAMEUSERS.webpush.sendConfigBrowserInfo()})},GAMEUSERS.webpush.sendConfigBrowserInfo=function(){if(GAMEUSERS.webpush.endpoint&&GAMEUSERS.webpush.publicKey&&GAMEUSERS.webpush.authToken){var a=new FormData;a.append("endpoint",GAMEUSERS.webpush.endpoint),a.append("public_key",GAMEUSERS.webpush.publicKey),a.append("auth_token",GAMEUSERS.webpush.authToken);var b=$("#form_fuel_csrf_token").val();a.append("fuel_csrf_token",b),$.ajax({url:uri_base+"rest/user/save_notification_data.json",dataType:"json",type:"POST",data:a,enctype:"multipart/form-data",processData:!1,contentType:!1}).done(function(){}).fail(function(){}).always(function(a){})}};
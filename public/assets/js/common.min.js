var GAMEUSERS=GAMEUSERS||{};GAMEUSERS.namespace=function(d){var c=d.split("."),b=GAMEUSERS,a;if(c[0]==="GAMEUSERS"){c=c.slice(1)}for(a=0;a<c.length;a+=1){if(typeof b[c[a]]==="undefined"){b[c[a]]={}}b=b[c[a]]}};GAMEUSERS.namespace("GAMEUSERS.common");GAMEUSERS.common.openedContent=null;GAMEUSERS.common.headerHeight=null;GAMEUSERS.common.bsTabHeight=null;GAMEUSERS.common.scrollMargin=null;GAMEUSERS.common.headerBsTabMarginSize=null;GAMEUSERS.common.swiperSocialButton=null;GAMEUSERS.common.swiperHelp=null;GAMEUSERS.common.masonryFeed=null;GAMEUSERS.common.masonryFooter=null;var swiperSlideGameList;var swiperSlideAmazonAd;var scrollBlankSize=-117;$(function(){var c=window.location.href.split(uri_base)[1];c=c.split("/");GAMEUSERS.common.urlParam1=c[1];GAMEUSERS.common.urlParam2=c[2];GAMEUSERS.common.urlParam3=c[3];GAMEUSERS.common.urlParam4=c[4];if(typeof(contents_data)!=="undefined"){window.history.pushState(contents_data[contents_data.initial_load.group+"_"+contents_data.initial_load.content].state,null,uri_current)}if($(".cd-auto-hide-header")[0]){GAMEUSERS.common.readNotificationsUnreadTotal()}else{readNotificationsUnreadTotal()}GAMEUSERS.common.headerHeightVer2=$(".cd-auto-hide-header").outerHeight(true);GAMEUSERS.common.tabHeightVer2=$(".cd-secondary-nav").outerHeight(true);GAMEUSERS.common.scrollMargin=GAMEUSERS.common.headerHeightVer2+GAMEUSERS.common.tabHeightVer2+20;$(document).on("click","#header_notifications",function(){var e=$(this).data("user_no");GAMEUSERS.common.readNotifications(this,1,e);$("#notifications_modal").modal("toggle");return false});if($("#swiper_container_social_button")[0]){GAMEUSERS.common.swiperSocialButton=new Swiper("#swiper_container_social_button",{slidesPerView:"auto",freeMode:true});var b=location.href;GAMEUSERS.common.socialCountTwitter(b);GAMEUSERS.common.socialCountFacebook(b);GAMEUSERS.common.socialCountGooglePlus(b);GAMEUSERS.common.socialCountHatena(b);GAMEUSERS.common.socialCountPocket(b);var a=$("#swiper_container_social_button").data("version");if(a==2){$("#twitter, #facebook, #google_plus, #hatena, #pocket, #line, #email").jrumble({x:2,y:2,rotation:1,speed:20});$("#twitter, #facebook, #google_plus, #hatena, #pocket, #line, #email").hover(function(){$(this).trigger("startRumble")},function(){$(this).trigger("stopRumble")})}}if($("#swiper_container_slide_game_list")[0]){swiperSlideGameList=new Swiper("#swiper_container_slide_game_list",{slidesPerView:"auto",freeMode:true,freeModeMomentumRatio:0.5,autoplay:2500,autoplayDisableOnInteraction:true,loop:true});$("#slide_game_list_select_menu").change(function(){slideGameList(content_id)})}if($("#swiper_container_slide_amazon_ad")[0]){swiperSlideAmazonAd=new Swiper("#swiper_container_slide_amazon_ad",{slidesPerView:"auto",freeMode:true,freeModeMomentumRatio:0.5,autoplay:2500,autoplayDisableOnInteraction:true,loop:true});$('[data-toggle="tooltip"]').tooltip({container:"body"})}if($("#bsTab")[0]){GAMEUSERS.common.bsTabFixed.setUp()}GAMEUSERS.common.headerHeight=$("header").outerHeight(true);GAMEUSERS.common.bsTabHeight=$("#bsTab").height();GAMEUSERS.common.headerBsTabMarginSize=GAMEUSERS.common.headerHeight+GAMEUSERS.common.bsTabHeight+10;$(".cd-secondary-nav ul li a").on("click",function(m){m.preventDefault();var l=$(this).data("group");var j=contents_data.opened_content[l];var k=contents_data[l+"_"+j].state;var h=contents_data[l+"_"+j].url;window.history.pushState(k,null,h);GAMEUSERS.common.changeMenuContents(this,l,null);var g=contents_data[l+"_"+j].meta_title;var i=contents_data[l+"_"+j].meta_keywords;var f=contents_data[l+"_"+j].meta_description;if(g&&i&&f){GAMEUSERS.common.rewriteMeta(g,i,f)}if(l==="feed"&&agent_type===""){GAMEUSERS.common.masonryFeed.masonry()}});$("[id^=change_contents_]").hide();$("[id^=change_contents_].active").show();GAMEUSERS.common.searchGameListNo(null);$(document).on("change","#help_menu",function(){var g=$(this).val().split("/");var f=g[0];var e=g[1];if($("#content_help_index")[0]){GAMEUSERS.common.readHelpVer2(this,1,f,e)}else{GAMEUSERS.common.readHelp(this,1,f,e)}});$(document).on("click","#jslink",function(h){h.preventDefault();var g="_self";var f=$(this).data("jslink");window.open(f,g)});if($("#about_amazon_ad")[0]){PNotify.prototype.options.delay=5000;$(document).on("click","#about_amazon_ad",function(){var e=$(this).data("title");var f=$(this).data("text");new PNotify({styling:"bootstrap3",title:e,text:f})})}if($("#footer_content_card")[0]){$("footer").imagesLoaded(function(){GAMEUSERS.common.masonryFooter=$("footer .card_box").masonry({itemSelector:".card_game"})})}$("#footer_select_box").change(function(){var e=$("#footer_select_box option:selected").val();$.cookie("footer_type",e);GAMEUSERS.common.readFooterCard(this)});var d=true;$("footer").on("mouseenter",function(){if(d){GAMEUSERS.common.readGameIndex(this,1);d=false}});$("[id^=footer_button_]").on("click",function(){$("[id^=footer_button_]").removeClass("active");$(this).addClass("active");var e=$(this).data("type");$("[id^=footer_content_]").addClass("element_hidden");$("#footer_content_"+e).removeClass("element_hidden");if(d){GAMEUSERS.common.readGameIndex(this,1);d=false}});$("#menu_to_top").on("click",function(){GAMEUSERS.common.stickyStuck=false;scrollToAnchor("main",-(GAMEUSERS.common.headerHeightVer2+GAMEUSERS.common.tabHeightVer2),0)});$("#menu_to_bottom").on("click",function(){GAMEUSERS.common.stickyStuck=false;scrollToAnchor("#swiper_container_social_button",-(GAMEUSERS.common.headerHeightVer2+GAMEUSERS.common.tabHeightVer2),0)});$("body").magnificPopup({delegate:"[id=modal_image]",type:"image"});$(document).on("focus","textarea",function(f){autosize($(this))});$(document).on("click","[data-invalid-link=true]",function(f){f.preventDefault()})});GAMEUSERS.common.stickySelector=null;GAMEUSERS.common.stickyStuck=false;GAMEUSERS.common.stickyAnimationDone=true;GAMEUSERS.common.stickyExistenceArr=[];GAMEUSERS.common.stickyMenu=function(a,b){GAMEUSERS.common.stickySelector=$(a);GAMEUSERS.common.stickyMenuAnimation(0,0);if($.inArray(a,GAMEUSERS.common.stickyExistenceArr)!==-1){return}else{GAMEUSERS.common.stickyExistenceArr.push(a)}var c=0;if(b==="rectangle"){c=-180}else{if(b==="none"){c=100}else{if(b==="small"){c=100}}}GAMEUSERS.common.stickySelector.stick_in_parent({offset_top:c,spacer:false}).on("sticky_kit:stick",function(f){GAMEUSERS.common.stickyStuck=true}).on("sticky_kit:unstick",function(f){GAMEUSERS.common.stickyStuck=false;GAMEUSERS.common.stickyMenuAnimation(0,600)}).on("sticky_kit:bottom",function(f){}).on("sticky_kit:unbottom",function(f){});var d=$(window).scrollTop();$(window).on("scroll",function(){var f=parseInt(GAMEUSERS.common.stickySelector.css("padding-top"));var e=$(window).scrollTop();if((GAMEUSERS.common.stickySelector.height()+50)>$("main article:visible").height()){}else{if(d>e&&GAMEUSERS.common.stickyStuck&&f===0&&GAMEUSERS.common.stickyAnimationDone){GAMEUSERS.common.stickyAnimationDone=false;GAMEUSERS.common.stickyMenuAnimation(GAMEUSERS.common.headerHeightVer2,450)}else{if(d<e&&GAMEUSERS.common.stickyStuck&&f===50&&GAMEUSERS.common.stickyAnimationDone){GAMEUSERS.common.stickyAnimationDone=false;GAMEUSERS.common.stickyMenuAnimation(0,280)}}}d=e})};GAMEUSERS.common.stickyMenuAnimation=function(a,b){if(GAMEUSERS.common.stickySelector){GAMEUSERS.common.stickySelector.stop();GAMEUSERS.common.stickySelector.animate({paddingTop:a+"px"},{duration:b,complete:function(){GAMEUSERS.common.stickyAnimationDone=true}})}};GAMEUSERS.common.openedGroupObj={};GAMEUSERS.common.changeMenuContents=function(a,c,b){if(b){contents_data.opened_content[c]=b}else{b=contents_data.opened_content[c]}$(".cd-secondary-nav ul li a").removeClass("active");$(".cd-secondary-nav [data-group="+c+"]").addClass("active");$("[id^=content_]").addClass("element_hidden");$("#content_"+c+"_"+b).removeClass("element_hidden");$("[id^=menu_]").addClass("element_hidden");$("#menu_"+c).removeClass("element_hidden");$("main .menu").removeClass(function(d,e){return(e.match(/\menu_margin_\S+/g)||[]).join(" ")});$("main .menu").addClass("menu_margin_"+c);GAMEUSERS.common.stickyMenuAnimation(0,600);GAMEUSERS.common.stickyStuck=false;scrollToAnchor("main",-(GAMEUSERS.common.headerHeightVer2+GAMEUSERS.common.tabHeightVer2),0)};GAMEUSERS.common.readFeed=function(a,e,f,c,h,d){var b="#feed_card_box";if(c){loadingToggle(a,null)}var g=new FormData();g.append("api_type","feed");g.append("type",f);g.append("page",e);var i=$("#form_fuel_csrf_token").val();g.append("fuel_csrf_token",i);$.ajax({url:uri_base+"rest/api/common.json",dataType:"json",type:"POST",data:g,enctype:"multipart/form-data",processData:false,contentType:false}).done(function(j){if(j.code_feed){$('[id="menu_card"][data-feed="'+f+'"]').data("page",e);if(h){scrollToAnchor("main",-(GAMEUSERS.common.headerHeightVer2+GAMEUSERS.common.tabHeightVer2),0)}$(b).html(j.code_feed);contents_data.feed_index.state=j.state;contents_data.feed_index.url=j.url;contents_data.feed_index.meta_title=j.meta_title;contents_data.feed_index.meta_keywords=j.meta_keywords;contents_data.feed_index.meta_description=j.meta_description;if(d){GAMEUSERS.common.changeUrlAndMeta("feed","index");$("#tab_feed a").attr("href",j.url)}if(agent_type!=="smartphone"){GAMEUSERS.common.thumbnailAdHideShow();$(b).not(".card_thumbnail").imagesLoaded(function(){GAMEUSERS.common.masonryFeed.masonry("reloadItems");GAMEUSERS.common.masonryFeed.masonry("layout");AOS.init({disable:true});GAMEUSERS.common.stickyMenuAnimation(0,600)})}}if(j.code_feed_pagination){$("#feed_pagination").html(j.code_feed_pagination)}}).fail(function(){if(uri_base.indexOf("https://gameusers.org/")===-1){alert("error")}}).always(function(){if(c){loadingToggle(a,null)}})};GAMEUSERS.common.readCommunityList=function(a,f,g,d,c,i,e){var b="#community_list";if(c){loadingToggle(a,null)}var h=new FormData();h.append("api_type","community_list");h.append("type",g);if(d){h.append("user_no",d)}h.append("page",f);var j=$("#form_fuel_csrf_token").val();h.append("fuel_csrf_token",j);$.ajax({url:uri_base+"rest/api/common.json",dataType:"json",type:"POST",data:h,enctype:"multipart/form-data",processData:false,contentType:false}).done(function(k){if(k.code){$(b).html(k.code);if(i){scrollToAnchor("main",-(GAMEUSERS.common.headerHeightVer2+GAMEUSERS.common.tabHeightVer2),0)}contents_data.community_index.state=k.state;contents_data.community_index.url=k.url;contents_data.community_index.meta_title=k.meta_title;contents_data.community_index.meta_keywords=k.meta_keywords;contents_data.community_index.meta_description=k.meta_description;if(e){GAMEUSERS.common.changeUrlAndMeta("community","index");$("#tab_community a").attr("href",k.url)}}}).fail(function(){if(uri_base.indexOf("https://gameusers.org/")===-1){alert("error")}}).always(function(){if(c){loadingToggle(a,null)}})};GAMEUSERS.common.readWikiList=function(f,g,h,b,e){var d="#wiki_list";if(h){loadingToggle(f,null)}var c=new FormData();c.append("api_type","wiki_list");c.append("page",g);var a=$("#form_fuel_csrf_token").val();c.append("fuel_csrf_token",a);$.ajax({url:uri_base+"rest/api/common.json",dataType:"json",type:"POST",data:c,enctype:"multipart/form-data",processData:false,contentType:false}).done(function(i){if(i.code){$(d).html(i.code);if(h){scrollToAnchor("main",-(GAMEUSERS.common.headerHeightVer2+GAMEUSERS.common.tabHeightVer2),0)}contents_data.wiki_index.state=i.state;contents_data.wiki_index.url=i.url;contents_data.wiki_index.meta_title=i.meta_title;contents_data.wiki_index.meta_keywords=i.meta_keywords;contents_data.wiki_index.meta_description=i.meta_description;if(e){GAMEUSERS.common.changeUrlAndMeta("wiki","index");$("#tab_wiki a").attr("href",i.url)}}}).fail(function(){if(uri_base.indexOf("https://gameusers.org/")===-1){alert("error")}}).always(function(){if(h){loadingToggle(f,null)}})};GAMEUSERS.common.readFooterCard=function(d){var c="footer .card_box";var b=new FormData();b.append("api_type","footer_card");var a=$("#form_fuel_csrf_token").val();b.append("fuel_csrf_token",a);$.ajax({url:uri_base+"rest/api/common.json",dataType:"json",type:"POST",data:b,enctype:"multipart/form-data",processData:false,contentType:false}).done(function(e){if(e.code){$(c).html(e.code);$(c).imagesLoaded(function(){GAMEUSERS.common.masonryFooter.masonry("reloadItems");GAMEUSERS.common.masonryFooter.masonry("layout")})}}).fail(function(){if(uri_base.indexOf("https://gameusers.org/")===-1){alert("error")}}).always(function(){})};GAMEUSERS.common.readGameIndex=function(f,g){var b="#footer_game_index_menu";var e="#footer_game_index";loadingToggle(f,null);var d=new FormData();d.append("api_type","game_index");if(!$(".index_game_list_search_keyword_button")[0]){d.append("first_load",true)}d.append("page",g);var c=$(f).data("keyword");if(c){d.append("keyword",c)}var a=$("#form_fuel_csrf_token").val();d.append("fuel_csrf_token",a);$.ajax({url:uri_base+"rest/api/common.json",dataType:"json",type:"POST",data:d,enctype:"multipart/form-data",processData:false,contentType:false}).done(function(h){if(h.code_menu){$(b).html(h.code_menu)}if(h.code){$(e).html(h.code);if(c){$(e+" #collapseListGroup0").collapse("show")}}}).fail(function(){if(uri_base.indexOf("https://gameusers.org/")===-1){alert("error")}}).always(function(){loadingToggle(f,null)})};GAMEUSERS.common.thumbnailAdHideShow=function(b){var a=$(window).width();if(a<1125){$("[data-thumbnail-hide=true]").hide()}else{$("[data-thumbnail-hide=true]").show()}};GAMEUSERS.common.socialShare=function(a){var g=$(a).attr("id");var c=null;var i=encodeURIComponent($("title").text());var b=encodeURIComponent(location.href);var j="";var h="Share";if(g==="twitter"){c="https://twitter.com/share?url="+b+"&text="+i;j="Twitter"}else{if(g==="facebook"){c="https://www.facebook.com/sharer/sharer.php?u="+b;j="Facebook"}else{if(g==="google_plus"){c="https://plus.google.com/share?url="+b;j="Google+"}else{if(g==="hatena"){c="http://b.hatena.ne.jp/entry/"+b;j="Hatena"}else{if(g==="pocket"){c="http://getpocket.com/edit?url="+b;j="Pocket"}else{if(g==="line"){var d=encodeURIComponent($("title").text()+" "+location.href);c="http://line.me/R/msg/text/?"+d;j="LINE"}else{if(g==="email"){var f="Game Users";var e=$("title").text()+"%0A"+location.href;location.href="mailto:?subject="+f+"&body="+e;j="Email"}}}}}}}if(c){window.open(c,"_blank")}if(uri_base.indexOf("gameusers.org")!==-1){ga("send","social",j,h,"'"+uri_current+"'")}};GAMEUSERS.common.socialCountTwitter=function(b){var a="#swiper_container_social_button #twitter span";if(b.indexOf("gameusers.org")===-1){return}$.ajax({url:"https://jsoon.digitiminimi.com/twitter/count.json",dataType:"jsonp",data:{url:b}}).done(function(c){if(c.count){$(a).html(c.count)}else{$(a).html(0)}}).fail(function(){}).always(function(){})};GAMEUSERS.common.socialCountFacebook=function(b){var a="#swiper_container_social_button #facebook span";$.ajax({url:"https://graph.facebook.com/",dataType:"jsonp",data:{id:b}}).done(function(c){try{if(c.share.share_count){$(a).html(c.share.share_count)}else{$(a).html(0)}}catch(d){$(a).html(0)}}).fail(function(){}).always(function(){})};GAMEUSERS.common.socialCountGooglePlus=function(c){var b="#swiper_container_social_button #google_plus span";var a=new FormData();a.append("url",c);$.ajax({url:uri_base+"rest/social/count_google_plus.json",dataType:"json",type:"POST",data:a,enctype:"multipart/form-data",processData:false,contentType:false}).done(function(d){if(d.count){$(b).html(d.count)}else{$(b).html(0)}}).fail(function(){}).always(function(){})};GAMEUSERS.common.socialCountHatena=function(b){var a="#swiper_container_social_button #hatena span";$.ajax({url:"https://b.hatena.ne.jp/entry.count",dataType:"jsonp",data:{url:b}}).done(function(c){if(c){$(a).html(c)}else{$(a).html(0)}}).fail(function(){}).always(function(){})};GAMEUSERS.common.socialCountPocket=function(c){var b="#swiper_container_social_button #pocket span";var a=new FormData();a.append("url",c);$.ajax({url:uri_base+"rest/social/count_pocket.json",dataType:"json",type:"POST",data:a,enctype:"multipart/form-data",processData:false,contentType:false}).done(function(d){if(d.count){$(b).html(d.count)}else{$(b).html(0)}}).fail(function(){}).always(function(){})};GAMEUSERS.common.bsTabFixed=(function(){var a;var c;var b;setUp=function(){var d=$("#bsTab");var f=d.offset();var e=$(".content_box").width();$(window).on("scroll resize",function(){var g=$(window).scrollTop();e=$(".content_box").width();if(g>(f.top-65)){d.addClass("fixed");$("body").css("margin-top",d.height());$(".bsTab.fixed").css("width",e+"px")}else{d.removeClass("fixed");$("body").css("margin-top","0px");$(".bsTab").css("width","100%")}});$(window).trigger("scroll")};return{setUp:setUp}}());GAMEUSERS.common.contentFixed=(function(){var i=0;var k;var f;var l=0;var g=0;var b=0;var d;var j;var e;var a;var h=[];var c={};setUp=function(){$(".content_box").imagesLoaded(function(){k=$("#content_"+GAMEUSERS.common.openedContent+" #content_left_box");f=$("#content_"+GAMEUSERS.common.openedContent+" #content_right_box");e=f.offset().top+f.outerHeight(true)-k.outerHeight(true)-parseInt(k.css("margin-top"),10);if($.inArray(GAMEUSERS.common.openedContent,h)!==-1){refresh();return}d=k.offset().top-parseInt(k.css("margin-top"),10);j=f.offset().top-parseInt(f.css("margin-top"),10);c[GAMEUSERS.common.openedContent]=k.height();$(window).on("scroll resize",function(){var n=$(".content_box").width();var m=n*0.7;var o=n-m;k.css("width",o);f.css("width",m)});l=$("#bsTab").height();g=$("header").outerHeight(true);b=l+g+10;k.perfectScrollbar({wheelPropagation:true,swipePropagation:true});$(window).on("resize",function(){if(k.outerHeight(true)>f.outerHeight(true)){}else{if($(window).height()>(k.height()+b)){k.height(c[GAMEUSERS.common.openedContent])}else{k.height($(window).height()-b)}}k.perfectScrollbar("update")});if(k.outerHeight(true)+d<f.outerHeight(true)+j){$(window).scroll(function(){var m=$(window).scrollTop();if(k.outerHeight(true)>f.outerHeight(true)){k.css({position:"static"})}else{if(m>(e-b)){k.css({position:"fixed",top:e-m+"px"})}else{if(m>(d-b)){k.css({position:"fixed",top:b+"px"})}else{k.css({position:"relative",top:"0px"})}}}})}h.push(GAMEUSERS.common.openedContent);refresh()})};refresh=function(){k.css("height","auto");c[GAMEUSERS.common.openedContent]=k.height();e=f.offset().top+f.outerHeight(true)-k.outerHeight(true)-parseInt(k.css("margin-top"),10);$(window).trigger("scroll");$(window).trigger("resize")};return{setUp:setUp}}());GAMEUSERS.common.changeContents=function(a,c,b){$(a).siblings().removeClass("active");$(a).addClass("active");$("[id^=change_contents_"+c+"]").hide();$("#change_contents_"+c+"_"+b).show()};GAMEUSERS.common.searchGameListNo=function(a){var b;if(a){b=$(a)}else{b=$("#game_list_form_box #scrollable-dropdown-menu .typeahead")}var c=new Bloodhound({limit:10,datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:uri_base+"rest/common/search_game_name.json?keyword=%QUERY"});c.initialize();b.typeahead(null,{name:"gameNameTypeahead",displayKey:"value",source:c.ttAdapter(),templates:{suggestion:function(d){return'<p class="needsclick">'+d.name+"</p>"}}}).bind("typeahead:selected",function(f,g){var d=$(this).closest("#game_list_form_box").find("#game_list");var e=d.data("game-list");if(!e){e=[]}if($.inArray(parseInt(g.game_no),e)==-1){e.push(g.game_no);$(d).append('<div class="original_label_game bgc_lightseagreen cursor_pointer" id="game_list_no_'+g.game_no+'" onclick="GAMEUSERS.common.deleteGameListNo(this, '+g.game_no+')">'+g.name+"</div>")}})};GAMEUSERS.common.deleteGameListNo=function(d,c){var b=$(d).closest("#game_list");var a=$(b).data("game-list");$.each(a,function(e,f){if(f==c){a.splice(e,1)}});$(b).find("#game_list_no_"+c).remove()};function slideGameList(c){var b=new FormData();b.append("type",$("#slide_game_list_select_menu").val());if(typeof appMode!="undefined"){b.append("app_mode",true)}var a=$("#form_fuel_csrf_token").val();b.append("fuel_csrf_token",a);$.ajax({url:uri_base+"rest/common2/slide_game_list.json",dataType:"json",type:"POST",data:b,enctype:"multipart/form-data",processData:false,contentType:false}).done(function(d){if(d.code){$("#swiper_container_slide_game_list div").html(d.code);swiperSlideGameList.update(true)}}).fail(function(){}).always(function(){})}function getContentId(a){return $(a).parents(".content_box").attr("id")}function changeLanguage(a){if(uri_base.indexOf("gameusers.org")!=-1){$.cookie("language",a,{expires:365,path:"/",domain:"gameusers.org",secure:true})}else{$.cookie("language",a)}location.href=uri_current}function plusGood(e,d,f){var c=e;if($(c).data("checked")){$(c).popover("toggle");return}loadingStart(c);var b=new FormData();b.append("type",d);if(d=="recruitment"||d=="recruitment_reply"){b.append("id",f)}else{b.append("no",f)}var a=$("#form_fuel_csrf_token").val();b.append("fuel_csrf_token",a);$.ajax({url:uri_base+"rest/common/plus_good.json",dataType:"json",type:"POST",data:b,enctype:"multipart/form-data",processData:false,contentType:false}).done(function(g){if(g.good){if(g.level_id_user){$("[id="+g.level_id_user+"]").text(g.level_user)}if(g.level_id_profile){$("[id="+g.level_id_profile+"]").text(g.level_profile)}$(c).children("#good_"+d+"_"+f).text(g.good)}else{$(c).popover({html:false,trigger:"manual",placement:"bottom",title:"ERROR",content:g.alert_message});$(c).popover("toggle");$(c).data("checked",true);$(c).on("shown.bs.popover",function(){goodStopTimeout=setTimeout(function(){$(c).popover("hide")},2000)}).on("hidden.bs.popover",function(){clearTimeout(goodStopTimeout)});$("body").on("click",function(h){$(c).each(function(){if(!$(this).is(h.target)&&$(this).has(h.target).length===0&&$(".popover").has(h.target).length===0){$(this).popover("hide")}})})}}).fail(function(){if(uri_base.indexOf("https://gameusers.org/")===-1){alert("error")}}).always(function(){loadingStop(c)})}GAMEUSERS.common.readNotifications=function(f,g,c){var b="#notifications_box";var d=$(f).attr("id");if(d!=="header_notifications"){loadingToggle(f,null)}var a=new FormData();a.append("page",g);a.append("user_no",c);var e;if(d=="read_notifications_unread"){e="unread";$(b).data("type","unread");$("#read_notifications_unread").attr("class","btn btn-default ladda-button active");$("#read_notifications_already").attr("class","btn btn-default ladda-button");$("#notifications_change_all_unread_button").show()}else{if(d=="read_notifications_already"){e="already";$(b).data("type","already");$("#read_notifications_unread").attr("class","btn btn-default ladda-button");$("#read_notifications_already").attr("class","btn btn-default ladda-button active");$("#notifications_change_all_unread_button").hide()}else{e=$(b).data("type")}}a.append("type",e);$.ajax({url:uri_base+"rest/user/read_notifications.json",dataType:"json",type:"POST",data:a,enctype:"multipart/form-data",processData:false,contentType:false}).done(function(j){if(j.code){$(b).html(j.code);var h=$("#header_notifications_unread_total").text();var k=$("#header_notifications_unread_total").data("unread_id");var l;if(k){l=k.split(",")}else{l=[]}var i;if(j.unread_id){i=j.unread_id.split(",")}else{i=[]}var n=0;$.each(i,function(o,p){if($.inArray(p,l)==-1){l.push(p);n++}});var m=0;if(h-n<0){m=0}else{m=h-n}$("#header_notifications_unread_total").text(m);k=l.join(",");$("#header_notifications_unread_total").data("unread_id",k)}else{$(b).html("")}}).fail(function(){if(uri_base.indexOf("https://gameusers.org/")===-1){alert("error")}}).always(function(){if(d!=="header_notifications"){loadingToggle(f,null)}if(d=="read_notifications_unread"){$("#notifications_change_all_unread_button").show()}else{if(d=="read_notifications_already"){$("#notifications_change_all_unread_button").hide()}}})};function readNotifications(f,g,c){var h=getContentId(f);var b="#notifications_box";var d=$(f).attr("id");if(d!=="header_notifications"){loadingToggle(f,null)}var a=new FormData();a.append("page",g);a.append("user_no",c);var e;if(d=="read_notifications_unread"){e="unread";$(b).data("type","unread");$("#read_notifications_unread").attr("class","btn btn-default ladda-button active");$("#read_notifications_already").attr("class","btn btn-default ladda-button");$("#notifications_change_all_unread_button").show()}else{if(d=="read_notifications_already"){e="already";$(b).data("type","already");$("#read_notifications_unread").attr("class","btn btn-default ladda-button");$("#read_notifications_already").attr("class","btn btn-default ladda-button active");$("#notifications_change_all_unread_button").hide()}else{e=$(b).data("type")}}a.append("type",e);if(typeof appMode!="undefined"){a.append("app_mode",appMode)}$.ajax({url:uri_base+"rest/user/read_notifications.json",dataType:"json",type:"POST",data:a,enctype:"multipart/form-data",processData:false,contentType:false}).done(function(k){if(k.code){$(b).html(k.code);initPlayerNotifications(h);var i=$("#header_notifications_unread_total").text();var l=$("#header_notifications_unread_total").data("unread_id");var m;if(l){m=l.split(",")}else{m=[]}var j;if(k.unread_id){j=k.unread_id.split(",")}else{j=[]}var o=0;$.each(j,function(p,q){if($.inArray(q,m)==-1){m.push(q);o++}});var n=0;if(i-o<0){n=0}else{n=i-o}$("#header_notifications_unread_total").text(n);l=m.join(",");$("#header_notifications_unread_total").data("unread_id",l)}else{$(b).html("")}}).fail(function(){if(uri_base.indexOf("https://gameusers.org/")===-1){alert("error")}}).always(function(){if(d!=="header_notifications"){loadingToggle(f,null)}if(d=="read_notifications_unread"){$("#notifications_change_all_unread_button").show()}else{if(d=="read_notifications_already"){$("#notifications_change_all_unread_button").hide()}}})}function initPlayerNotifications(a){if($("#"+a+" #tab_notifications_"+a)[0]){$("#"+a+" #tab_notifications_"+a+" #player_notifications_long").hide()}$("#"+a+" #tab_notifications_"+a+" #player_notifications_read_all_button").on("click",function(){$(this).parents("#player_notifications_box").find("#player_notifications_long").toggle();$(this).parents("#player_notifications_box").find("#player_notifications_short").toggle()})}GAMEUSERS.common.readNotificationsUnreadTotal=function(){var b="#header_notifications_unread_total";var a=new FormData();$.ajax({url:uri_base+"rest/common/read_notifications_unread_total.json",dataType:"json",type:"POST",data:a,enctype:"multipart/form-data",processData:false,contentType:false}).done(function(c){if(c.total){$(b).html(c.total)}}).fail(function(){if(uri_base.indexOf("https://gameusers.org/")===-1){alert("error")}}).always(function(){})};function readNotificationsUnreadTotal(){var b="#header_notifications_unread_total";if(!$(b)[0]){return}if($(b).data("reading")){return}$(b).data("reading",true);var a=new FormData();if(typeof appMode!="undefined"){a.append("app_mode",appMode)}$.ajax({url:uri_base+"rest/common/read_notifications_unread_total.json",dataType:"json",type:"POST",data:a,enctype:"multipart/form-data",processData:false,contentType:false}).done(function(c){if(c.total){$(b).html(c.total)}else{$(b).html("-")}$(b).data("reading",false)}).fail(function(){}).always(function(){})}function changeAllUnreadToAlready(d){var a="未読のお知らせをすべて既読にします。よろしいですか？";if(!window.confirm(a)){return}var c="#header_notifications_unread_total";loadingToggle(d,null);var b=new FormData();if(typeof appMode!="undefined"){b.append("app_mode",appMode)}$.ajax({url:uri_base+"rest/common/change_all_unread_to_already.json",dataType:"json",type:"POST",data:b,enctype:"multipart/form-data",processData:false,contentType:false}).done(function(e){if(e.success){$("#notifications_box").html("");$(c).html("0")}}).fail(function(){if(uri_base.indexOf("https://gameusers.org/")===-1){alert("error")}}).always(function(){loadingToggle(d,null)})}function popupMovie(b){var a=$(b).data("url");$.magnificPopup.open({items:{src:a},type:"iframe"})}function rewriteUrl(){if(typeof appMode=="undefined"&&window.history&&window.history.pushState){var b=uri_current.replace(uri_base,"");var a=b.split("/");window.history.pushState("","",uri_base+a[0]+"/"+a[1]);$(window).on("popstate",function(){location.href=uri_current})}}GAMEUSERS.common.changeUrlAndMeta=function(g,e){var f=contents_data[g+"_"+e].state;var c=contents_data[g+"_"+e].url;if(f&&c){window.history.pushState(f,null,c)}var b=contents_data[g+"_"+e].meta_title;var d=contents_data[g+"_"+e].meta_keywords;var a=contents_data[g+"_"+e].meta_description;if(b&&d&&a){GAMEUSERS.common.rewriteMeta(b,d,a)}};GAMEUSERS.common.changeUrl=function(d,b){var c=contents_data[d+"_"+b].state;var a=contents_data[d+"_"+b].url;if(c&&a){window.history.pushState(c,null,a)}};GAMEUSERS.common.changeMeta=function(e,d){var b=contents_data[e+"_"+d].meta_title;var c=contents_data[e+"_"+d].meta_keywords;var a=contents_data[e+"_"+d].meta_description;if(b&&c&&a){document.title=GAMEUSERS.common.escapeHTML(b);$("meta[name=keywords]").attr("content",GAMEUSERS.common.escapeHTML(c));$("meta[name=description]").attr("content",GAMEUSERS.common.escapeHTML(a))}};GAMEUSERS.common.rewriteMeta=function(c,a,b){document.title=GAMEUSERS.common.escapeHTML(c);$("meta[name=keywords]").attr("content",GAMEUSERS.common.escapeHTML(a));$("meta[name=description]").attr("content",GAMEUSERS.common.escapeHTML(b))};function changeAdAppInstall(a,b){if(b){content_id=b}if(a===0){$("#"+content_id+" [id^=ad_app_install_main_]").hide();$("#"+content_id+" [id^=ad_app_install_main_]").eq(0).show()}else{$("#"+content_id+" [id^=ad_app_install_main_]").hide();$("#"+content_id+" #ad_app_install_main_"+a).show()}}GAMEUSERS.common.readHelp=function(d,g,f,e){if($("#content_help_index")[0]){GAMEUSERS.common.readHelpVer2(this,1,f,e);return}var c="#tab_help";var b=new FormData();var h=false;if(!$(c+" #content_left_box")[0]){h=true}if(h){b.append("first_load",1)}b.append("page",g);if(f){b.append("list",f)}if(e){b.append("content",e)}var a=$("#form_fuel_csrf_token").val();b.append("fuel_csrf_token",a);$.ajax({url:uri_base+"rest/help/read_help.json",dataType:"json",type:"POST",data:b,enctype:"multipart/form-data",processData:false,contentType:false}).done(function(i){if(i.code_all){$(c).html(i.code_all)}if(i.code_list){$(c+" #content_left_box").html(i.code_list)}if(i.code_content){$(c+" #content_right_box").html(i.code_content)}$(c).imagesLoaded(function(){if(agent_type!==""&&h){GAMEUSERS.common.swiperHelp=new Swiper("#swiper_container_help",{autoHeight:true,touchRatio:1,touchAngle:10,shortSwipes:false,longSwipesRatio:0.1,longSwipesMs:50,prevButton:"#content_prev_button_help",nextButton:"#content_next_button_help"});GAMEUSERS.common.swiperHelp.on("slideChangeStart",function(){scrollToAnchor("#swiper_container_help",-123,0)});GAMEUSERS.common.swiperHelp.slideNext()}if(agent_type===""){if(GAMEUSERS.common.openedContent==="help"){GAMEUSERS.common.contentFixed.setUp();scrollToAnchor(c+" #content_right_box",-120,0)}}else{GAMEUSERS.common.swiperHelp.update(true);if(!i.code_list&&i.code_content&&GAMEUSERS.common.swiperHelp.activeIndex===0){GAMEUSERS.common.swiperHelp.slideNext()}}})}).fail(function(){if(uri_base.indexOf("https://gameusers.org/")===-1){alert("error")}}).always(function(i){})};GAMEUSERS.common.readHelpVer2=function(c,f,e,d){var g=true;if($("#help").html()!==""){g=false}var b=new FormData();b.append("page",f);if(e){b.append("list",e)}if(d){b.append("content",d)}var a=$("#form_fuel_csrf_token").val();b.append("fuel_csrf_token",a);$.ajax({url:uri_base+"rest/help/read_help.json",dataType:"json",type:"POST",data:b,enctype:"multipart/form-data",processData:false,contentType:false}).done(function(h){if(h.code_list){$("#menu_help").html(h.code_list)}if(h.code_content){$("#help").html(h.code_content)}if(!g){GAMEUSERS.common.stickyMenuAnimation(0,600);GAMEUSERS.common.stickyStuck=false;scrollToAnchor("main",-(GAMEUSERS.common.headerHeightVer2+GAMEUSERS.common.tabHeightVer2),0)}GAMEUSERS.common.closeSlideMenu()}).fail(function(){if(uri_base.indexOf("https://gameusers.org/")===-1){alert("error")}}).always(function(){})};GAMEUSERS.common.closeSlideMenu=function(){if(agent_type!==""&&$("#lastOverlay").is(":visible")){$("#lastOverlay").trigger("click")}};GAMEUSERS.common.escapeHTML=function(a){return a.replace(/&#039;/g,"'")};
